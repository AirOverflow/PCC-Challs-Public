#!/usr/bin/env python3

from pwn import *
from ctypes import *

context.terminal = ["tmux", "splitw", "-h"]
encode = lambda e: e if type(e) == bytes else str(e).encode()
hexleak = lambda l: int(l[:-1] if l[-1] == '\n' else l, 16)
fixleak = lambda l: unpack((l[:-1] if (l and l[-1]) == '\n' else l).ljust(8, b"\x00"))

exe = "./seed"
elf = context.binary = ELF(exe)
libc = cdll.LoadLibrary(elf.libc.path)


io = remote(sys.argv[1], int(sys.argv[2])
	) if args.REMOTE else process([exe], aslr=True)
if args.GDB: gdb.attach(io, """
	b *main
""")


libc.srand(libc.time(0x0))
for i in range(10):
	rnd = (libc.rand() >> 8) | (libc.rand() | 0xFFFF)
	io.sendlineafter(b"?", encode(rnd))

io.interactive()
